function isNumeric(t){return!isNaN(parseFloat(t))&&isFinite(t)}var hospitalApp=angular.module("hospitalApp",["ngSanitize","ngRoute","angucomplete","mgcrea.ngStrap","disableAll"]);hospitalApp.config(["$routeProvider",function(t){t.when("/",{templateUrl:"views/index.html"}).when("/micro-referral",{templateUrl:"views/micro-referral.html"}).when("/blood-cultures",{templateUrl:"views/blood-cultures.html"}).when("/opat",{templateUrl:"views/opat.html"}).when("/notifications",{templateUrl:"views/notifications.html"}).otherwise({templateUrl:"views/404.html"})}]),hospitalApp.run(["$route","$rootScope","$location",function(t,e,a){var i=a.path;a.path=function(n,o){if(o===!1)var s=t.current,l=e.$on("$locationChangeSuccess",function(){t.current=s,l()});return i.apply(a,[n])}}]),hospitalApp.factory("bloodCultureMainData",[function(){var t={id:"0",patient_id:"0",date_created:"",patient:{id:"",nhs_no:"",name:"",surname:"",date_birth:"",date_created:"",status:"1",hospital_id:""}};return{data:t,newData:t}}]),hospitalApp.service("doctorsData",["$http",function(t){var e={doctors:""};return e}]),hospitalApp.factory("fullTableData",[function(){return{pcatTable:{config:{fields:{id:{hidden:!0},micro_referral_id:{hidden:!0},agent_id:{name:"Agent",type:"select",itemsName:"agentsList",addon:'<a class="glyphicon glyphicon-plus-sign  text-success" data-toggle="modal" data-target="#agentsList" style="text-decoration: none;cursor: pointer;"></a>',width:"120px",percent_width:"20%"},date_commenced:{name:"Date Commenced",type:"date",width:"140px",percent_width:"20%"},date_stop:{name:"Date Stop",type:"date",width:"160px",percent_width:"20%"},indication_id:{name:"Indications",type:"select",width:"140px",percent_width:"40%",itemsName:"indicationsList",addon:'<a class="glyphicon glyphicon-plus-sign  text-success" data-toggle="modal" data-target="#indicationsList" style="text-decoration: none;cursor: pointer;"></a>'}}},data:[]},bloodsTable:{config:{fields:{id:{name:"ID",hidden:!0},micro_referral_id:{hidden:!0},date_created:{name:"Date",type:"date",width:"140px"},wcc:{name:"WCC",type:"text",width:"60px"},n0:{name:"N0",type:"text",width:"60px"},crp:{name:"CRP",type:"text",width:"60px"},egfr:{name:"EGFR",type:"text",width:"60px"},others:{name:"Others",type:"text",width:"60px"}}},data:[]},allergiesTable:{config:{fields:{id:{hidden:!0},micro_referral_id:{hidden:!0},allergy_id:{name:"Allergy",type:"select",itemsName:"allergiesList",addon:'<a class="glyphicon glyphicon-plus-sign  text-success" data-toggle="modal" data-target="#allergiesList" style="text-decoration: none;cursor: pointer;"></a>',width:"120px"},description:{name:"Details of reactions",type:"text",width:"120px"}}},data:[]},followupNotesTable:{config:{fields:{id:{hidden:!0},micro_referral_id:{hidden:!0},date_created:{name:"Date",type:"dateAttach",width:"140px"},note:{name:"Follow Up",type:"textarea",width:"120px"}}},data:[]},antibioticsTable:{data:[],newItem:[]},bloodCulturesTable:{data:[],newItem:[]},gramStainsTable:{config:{fields:{id:{hidden:!0},blood_culture_id:{hidden:!0},gram_stain_id:{name:"Gram Stains",type:"select",itemsName:"gramStainsList",addon:'<a class="glyphicon glyphicon-plus-sign  text-success" data-toggle="modal" data-target="#gramStainsList" style="text-decoration: none;cursor: pointer;"></a>'}}},data:[]},organismsTable:{config:{fields:{id:{hidden:!0},blood_culture_id:{hidden:!0},organism_id:{name:"Organisms",type:"select",itemsName:"organismsList",addon:'<a class="glyphicon glyphicon-plus-sign  text-success" data-toggle="modal" data-target="#organismsList" style="text-decoration: none;cursor: pointer;"></a>'}}},data:[]},stewardshipsTable:{config:{fields:{id:{hidden:!0},micro_referral_id:{hidden:!0},idic:{name:"IDIC",type:"bool",width:"60px",percent_width:"12%"},sdic:{name:"SDIC",type:"bool",width:"60px",percent_width:"12%"},ppi:{name:"PPI",type:"bool",width:"60px",percent_width:"12%"},rv_id:{name:"R/V at",type:"select",itemsName:"rvsList",addon:'<a class="glyphicon glyphicon-plus-sign  text-success" data-toggle="modal" data-target="#rvsList" style="text-decoration: none;cursor: pointer;"></a>',percent_width:"21%"},intervention_id:{name:"Intervention",type:"select",itemsName:"interventionsList",addon:'<a class="glyphicon glyphicon-plus-sign  text-success" data-toggle="modal" data-target="#interventionsList" style="text-decoration: none;cursor: pointer;"></a>',percent_width:"21%"},outcome_id:{name:"Outcomes",type:"select",itemsName:"outcomesList",addon:'<a class="glyphicon glyphicon-plus-sign  text-success" data-toggle="modal" data-target="#outcomesList" style="text-decoration: none;cursor: pointer;"></a>',percent_width:"22%"}}},data:[]}}}]),hospitalApp.factory("globalData",["$http","microReferralData",function(t,e){var a={readOnly:!0,patients:[],items:[]};return a.loadPatients=function(e){t.get(window.base_url+"/patient/get-all?type="+e).then(function(t){a.patients=t.data})},a}]),hospitalApp.factory("microReferralData",["$interval",function(t){var e={id:"0",patient_id:"0",specialty_id:"0",ward:"",team_bleeps:"",referring_doctor:"",date_referral:"",reason_id:"0",clinical_details:"",medical_history:"",investigations:"",clinical_advice:"",patient:{id:"",nhs_no:"",name:"",surname:"",date_birth:"",date_created:"",status:"1",hospital_id:""}};return{data:e,newData:e}}]),hospitalApp.factory("opatData",[function(){var t={id:"0",patient_id:"0",date_created:"0",sex:"",weight:"",age:"",specialty_id:"0",managing_doctor_id:"0",referring_consultant_id:"0",primary_infective_id:"0",date_referral:"",commisioning_board_id:"0",vad_type_id:"0",vad_insertion_date:"",vad_removal_date:"",complications_id:"0",outcome_id:"0",discharge_date:"",patient:{id:"",nhs_no:"",name:"",surname:"",date_birth:"",date_created:"",status:"1",hospital_id:""}};return{data:t,newData:t}}]),hospitalApp.factory("patientData",[function(){return{id:"",nhs_no:"",name:"",surname:"",date_birth:"",date_created:"",status:"1",hospital_id:""}}]),hospitalApp.factory("simpleTableData",[function(){return{specialtiesList:[{id:"1",name:"test 1"},{id:"2",name:"test 2"}],agentsList:[],allergiesList:[],reasonsList:[],antibioticsList:[{id:"1",name:"test 1"},{id:"2",name:"test 2"}],referringConsultantsList:[],managingDoctorsList:[],commisioningBoardsList:[],vadTypesList:[],primaryInfectiveList:[],complicationsList:[],outcomesList:[],organismsList:[],significantsList:[],gramStainsList:[],rvsList:[],interventionsList:[],indicationsList:[]}}]),function(){"use strict";function t(){return{restrict:"A"}}angular.module("disableAll",[]),angular.module("disableAll").directive("skipDisable",t);var e=function(t,e){return{restrict:"A",link:function(n,o,s){function l(){var t=s.disableElementId?document.getElementById(s.disableElementId):o[0];n.$watch(s.disableAll,function(e){e?a(t):i(t)}),n.$on("$destroy",function(){i(t)})}t(function(){l()}),e.$on("tablesLoaded",function(){t(function(){l()})})}}};e.$inject=["$timeout","$rootScope"],angular.module("disableAll").directive("disableAll",e);var a=function(t){angular.element(t).addClass("disable-all"),t.style.color="gray",o(t.getElementsByTagName("input")),o(t.getElementsByTagName("button")),o(t.getElementsByTagName("textarea")),o(t.getElementsByTagName("select")),t.addEventListener("click",n,!0)},i=function(t){angular.element(t).removeClass("disable-all"),t.style.color="inherit",s(t.getElementsByTagName("input")),s(t.getElementsByTagName("button")),s(t.getElementsByTagName("textarea")),s(t.getElementsByTagName("select")),t.removeEventListener("click",n,!0)},n=function(t){for(var e=0;e<t.target.attributes.length;e++){var a=t.target.attributes[e];if("skip-disable"===a.name)return!0}return t.stopPropagation(),t.preventDefault(),!1},o=function(t){for(var e=t.length,a=0;e>a;a++){for(var i=!0,n=0;n<t[a].attributes.length;n++){var o=t[a].attributes[n];"skip-disable"!==o.name||(i=!1)}i&&t[a].disabled===!1&&(t[a].disabled=!0,t[a].disabledIf=!0)}},s=function(t){for(var e=t.length,a=0;e>a;a++)t[a].disabled===!0&&t[a].disabledIf===!0&&(t[a].disabled=!1,t[a].disabledIf=null)}}(),hospitalApp.directive("field",["simpleTableData",function(t){return{replace:!0,templateUrl:function(t,e){var a=["text","select","date","dateAttach","bool","textarea"];return a.indexOf(e.type)>-1?"../js/directives/templates/"+e.type+"Field.html":void 0},scope:{value:"="},transclude:!0,link:function(e,a,i,n,o){e.simpleTableData=t,e.options={showTitle:!0,addon:!1},o(function(t){t.length&&(e.options.addon=!0)}),angular.extend(e.options,e.$eval(i.options)),e.uniqId=Date.now()+"_"+e.options.name,e.addon=!1,e.options.addon&&(e.addon=!0),e.name=!1,e.options.name&&(e.name=e.options.name),e.showTitle=!1,e.options.showTitle&&(e.showTitle=!0),e.inputGroupClass="",(e.options.showTitle||e.options.addon)&&(e.inputGroupClass="input-group"),e["class"]=!1,e.options["class"]&&(e["class"]=e.options["class"]),e.itemsName=!1,e.options.itemsName&&(e.itemsName=e.options.itemsName),e.width="0px",e.options.width&&(e.width=e.options.width)}}}]),hospitalApp.directive("fullTable",["$compile","globalData",function(t,e){return{replace:!0,template:'<table class="table table-no-borders"></table>',scope:{table:"=",thead:"@"},controller:function(a,i){a.globalData=e,a.newItem={},a.setNewId=function(){0!==a.table.data.length?a.newItem.id=parseInt(a.table.data[a.table.data.length-1].id)+1:a.newItem.id=1},a.generateNewItem=function(){angular.forEach(a.table.config.fields,function(t,e){"id"==e?a.setNewId():"select"==t.type?a.newItem[e]="0":a.newItem[e]=""})},a.generateNewItem(),a.$watch(function(){return a.table.data},function(t,e){a.setNewId()});var n="";if("false"!==a.thead){n+="<thead><tr>";var o=0;for(var s in a.table.config.fields)a.table.config.fields.hasOwnProperty(s)&&a.table.config.fields[s].hidden!==!0&&++o;var l=100/o-1+"%";angular.forEach(a.table.config.fields,function(t,e){return t.hidden?!1:(t.hasOwnProperty("percent_width")&&(l=t.percent_width),void(n+='<th style="width:'+l+'">'+t.name+"</th>"))}),n+="<th></th></tr></thead>",i.append(n)}n="<tbody>",n+="<tr>",angular.forEach(a.table.config.fields,function(t,e){if(t.hidden)return!1;var a={name:t.name,showTitle:!1};t.itemsName&&(a.itemsName=t.itemsName),t.width&&(a.width=t.width),n+="<td>",n+='<field type="'+t.type+'" value="newItem.'+e+'" options="'+angular.toJson(a).replace(/"/g,"'")+'">',t.addon&&(n+=t.addon),n+="</field>",n+="</td>"}),n+='<td><button class="btn btn-success" ng-click="addItem()"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span></button></td>',n+="</tr>",n+='<tr ng-repeat="(key, item) in table.data" ng-if="key !== \'id\'">',angular.forEach(a.table.config.fields,function(t,e){if(t.hidden)return!1;var a={name:t.name,showTitle:!1};t.itemsName&&(a.itemsName=t.itemsName),t.width&&(a.width=t.width),n+="<td>",n+='<field type="'+t.type+'" value="item.'+e+'" options="'+angular.toJson(a).replace(/"/g,"'")+'">',n+="</field>",n+="</td>"}),n+='<td><button class="btn btn-danger" ng-click="removeItem(item)"><span class="glyphicon glyphicon-trash" aria-hidden="true"></span></button></td>',n+="</tr>",n+="</tbody>",i.append(t(n)(a)),a.addItem=function(){a.table.data.push(angular.copy(a.newItem)),a.generateNewItem()},a.removeItem=function(t){var e=a.table.data.indexOf(t);a.table.data.splice(e,1),a.generateNewItem()}}}}]),hospitalApp.directive("toNumber",[function(){return{require:"ngModel",link:function(t,e,a,i){i.$parsers.push(function(t){return parseInt(t,10)}),i.$formatters.push(function(t){return""+t})}}}]),hospitalApp.directive("debugger",[function(){return{replace:!0,template:'<div style="position: fixed; left: 20px; top: 8%; width: 340px; height: 600px;z-index: 9999999;overflow: scroll;" class="__debug_info"><button data-toggle="collapse" data-target="#_debug" class="btn btn-warning">OpenDebug</button><pre id="_debug" class="collapse">{{ data | json }}</pre></div>',scope:{data:"="}}}]),hospitalApp.directive("jqueryUse",[function(){return function(t,e,a){setTimeout(function(){console.log("test")},0)}}]),hospitalApp.directive("searchModal",["$sce","$rootScope",function(t,e){return{replace:!0,templateUrl:"../js/directives/templates/searchModal.html",scope:{tableData:"=table",modalId:"@",title:"@",searchKey:"@",searchResultKeys:"@"},link:function(t,a,i){t.searchValue="",t.searchDone=!1,t.targetId="",t.$watch("searchValue",function(e,a){e&&e.hasOwnProperty("originalObject")?(t.targetId=e.originalObject.micro_referral_id,t.searchDone=!0):t.searchDone=!1}),t.goToMicroReferral=function(){if(""!==t.targetId&&t.searchDone===!0){var a=$("#"+t.modalId).modal("hide");a.on("hidden.bs.modal",function(){""!==t.targetId&&t.searchDone===!0&&(e.$broadcast("needChangeItem",{id:t.targetId}),t.searchValue="",t.targetId="",t.searchDone=!1)})}}}}}]),hospitalApp.directive("simpleTable",["globalData",function(t){return{replace:!0,templateUrl:"../js/directives/templates/simpleTable.html",scope:{title:"@",modalId:"@",items:"="},link:function(e){e.globalData=t,e.newItem={id:0,name:""},e.setNewId=function(){0!==e.items.length?e.newItem.id=parseInt(e.items[e.items.length-1].id)+1:e.newItem.id=1},e.$watch("items",function(t,a){e.setNewId()}),e.removeItem=function(t){var a=e.items.indexOf(t);e.items.splice(a,1),e.setNewId()},e.addItem=function(){e.items.push(angular.copy(e.newItem)),e.setNewId(),e.newItem.name=""}}}}]),hospitalApp.controller("ActionController",["$scope","$location","globalData","fullTableData","$rootScope",function(t,e,a,i,n){t.actionMode={value:"view",add:!0,edit:!0,remove:!0,undo:!1,search:!0,save:!1,prev:!0,next:!0,activate:function(e){switch(e){case"add":a.readOnly=!1,this.value="add",this.edit=!1,this.remove=!1,this.search=!1,this.save=!0,this.prev=!1,this.next=!1,0!==a.items.length&&(this.undo=!0),$("#patientsList").modal("show"),t.prepareNew();break;case"edit":a.readOnly=!1,this.value="edit",this.add=!1,this.edit=!0,this.remove=!1,this.undo=!0,this.search=!1,this.save=!0,this.prev=!1,this.next=!1;break;case"remove":a.readOnly=!0,this.value="view",this.actionDefaults(),confirm("Are you serious wan't to delete this record?")&&t.deleteInfo(function(e){1==e.success&&(t.loadItems(),t.loadPatients())});break;case"undo":if(a.readOnly=!0,"add"==this.value&&0===a.items.length)break;this.value="view",this.actionDefaults(),t.reloadItem();break;case"save":a.readOnly=!0;var i=!1;"add"==this.value&&(i=!0),t.saveInfo(function(e){1==e.success?(i&&(t.setItemId(e.id),t.loadItems(),t.loadPatients()),t.actionMode.value="view",t.actionMode.actionDefaults()):i?(t.actionMode.activate("add"),t.actionMode.undo=!1):t.actionMode.activate("edit")});break;case"prev":a.readOnly=!0,this.value="view",this.actionDefaults(),t.setItemId(t.navigationArrows.prevId),t.reloadItem();break;case"next":a.readOnly=!0,this.value="view",this.actionDefaults(),t.setItemId(t.navigationArrows.nextId),t.reloadItem();break;case"block":a.readOnly=!0,this.value="view",this.add=!1,this.edit=!1,this.remove=!1,this.undo=!1,this.search=!1,this.save=!1,this.prev=!1,this.next=!1;break;case"default":a.readOnly=!0,this.value="view",this.actionDefaults()}},actionDefaults:function(){this.add=!0,this.edit=!0,this.remove=!0,this.undo=!1,this.search=!0,this.save=!1,this.prev=!0,this.next=!0}},t.navigationArrows={prevId:0,nextId:0},t.getItemId=function(){var t=e.search();return isNumeric(t.id)?t.id:0},t.checkItemId=function(){return 0!==this.getItemId()},t.setItemId=function(t){e.path(e.path(),!1).search({id:t})},t.reloadItem=function(){t.actionMode.activate("block"),t.getInfo(t.getItemId(),function(){t.updateNavigationArrows(),t.actionMode.activate("default"),n.$broadcast("tablesLoaded")})},t.goToFirstItem=function(){void 0!==a.items[0]?t.setItemId(a.items[0].id):console.log("no items found!"),t.reloadItem()},t.checkIsItemExists=function(){var e=!1;return angular.forEach(a.items,function(a,i){a.id==t.getItemId()&&(e=!0)}),e},t.loadItems=function(){t.refreshItems(function(e){0!==e.length?t.checkItemId()&&t.checkIsItemExists()?t.reloadItem():t.goToFirstItem():(t.actionMode.activate("add"),t.actionMode.prev=!1,t.actionMode.next=!1,t.actionMode.undo=!1,t.getInfo(0,function(){n.$broadcast("tablesLoaded")}))})},t.updateNavigationArrows=function(){var e=t.getItemId();switch(Object.keys(a.items).length){case 0:t.actionMode.prev=!1,t.actionMode.next=!1;break;case 1:t.navigationArrows.prevId=e,t.navigationArrows.nextId=e;break;case 2:a.items[0].id!=e?(t.navigationArrows.prevId=a.items[0].id,t.navigationArrows.nextId=a.items[0].id):(t.navigationArrows.prevId=a.items[1].id,t.navigationArrows.nextId=a.items[1].id);break;default:angular.forEach(a.items,function(i,n){i.id==e&&("undefined"!=typeof a.items[n-1]?t.navigationArrows.prevId=a.items[n-1].id:t.navigationArrows.prevId=a.items[a.items.length-1].id,"undefined"!=typeof a.items[n+1]?t.navigationArrows.nextId=a.items[n+1].id:t.navigationArrows.nextId=a.items[0].id)})}},t.$on("needChangeItem",function(e,a){t.setItemId(a.id),t.reloadItem()}),t.$on("setActionMode",function(e,a){t.actionMode.activate(a.action)}),t.loadItems()}]),hospitalApp.controller("BloodCultureMainController",["$http","$scope","bloodCultureMainData","fullTableData","simpleTableData","globalData",function(t,e,a,i,n,o){e.globalData=o,e.bloodCultureMainData=a,e.simpleTableData=n,e.fullTableData=i,i.gramStainsTable.data=[],i.organismsTable.data=[],e.blood_culture_selected_index=-1,e.setBlodCultureSelected=function(t){e.blood_culture_selected_index=t,-1===t?(i.gramStainsTable.data=i.bloodCulturesTable.newItem.gram_stains_table_data,i.organismsTable.data=i.bloodCulturesTable.newItem.organisms_table_data):(i.gramStainsTable.data=i.bloodCulturesTable.data[t].gram_stains_table_data,i.organismsTable.data=i.bloodCulturesTable.data[t].organisms_table_data)},e._debug={globalData:o,bloodCultureMainData:a},e.prepareNew=function(){a.data=angular.copy(a.newData),i.bloodCulturesTable.data=[],i.gramStainsTable.data=[],i.organismsTable.data=[]},e.refreshItems=function(e){t.get(window.base_url+"blood-culture-main/get-all").then(function(t){""!==t.data&&(o.items=t.data),"function"==typeof e&&e(t.data)})},e.loadPatients=function(){o.loadPatients("blood_culture_main")},e.getInfo=function(e,o){t.get(window.base_url+"blood-culture-main/get-info?id="+e).then(function(t){""!==t.data&&(0!==e&&(a.data=t.data.blood_culture_main,i.bloodCulturesTable.data=t.data.blood_cultures_table_data),n.organismsList=t.data.organisms_list,n.significantsList=t.data.significants_list,n.gramStainsList=t.data.gram_stains_list,"function"==typeof o&&o())})},e.saveInfo=function(e){t.post(window.base_url+"blood-culture-main/save-info",{data:{blood_culture_main:a.data,blood_cultures_table_data:i.bloodCulturesTable.data,organisms_list:n.organismsList,significants_list:n.significantsList,gram_stains_list:n.gramStainsList},_csrf:document.getElementsByName("csrf-token")[0].content}).then(function(t){e(t.data)})},e.deleteInfo=function(e){t.post(window.base_url+"blood-culture-main/delete-info",{data:{blood_culture_id:a.data.id},_csrf:document.getElementsByName("csrf-token")[0].content}).then(function(t){e(t.data)})}}]),hospitalApp.controller("BloodCulturesTableController",["$scope","bloodCultureMainData","fullTableData",function(t,e,a){t.newItemCopy={id:"",blood_culture_main_id:"0",lab_no:"",date_sample:"",sensitivity_complete:"",significant_id:"0",follow_up_required:"",active_case:"",gram_stains_table_data:[],organisms_table_data:[]},t.fullTableData=a,a.bloodCulturesTable.newItem=angular.copy(t.newItemCopy),t.setNewItemId=function(){0!==a.bloodCulturesTable.data.length?a.bloodCulturesTable.newItem.id=parseInt(a.bloodCulturesTable.data[a.bloodCulturesTable.data.length-1].id)+1:a.bloodCulturesTable.newItem.id=1},t.generateNewItem=function(){a.bloodCulturesTable.newItem=angular.copy(t.newItemCopy),t.setNewItemId()},t.addItem=function(){a.bloodCulturesTable.data.push(angular.copy(a.bloodCulturesTable.newItem)),t.generateNewItem()},t.removeItem=function(e){var i=a.bloodCulturesTable.data.indexOf(e);a.bloodCulturesTable.data.splice(i,1),t.generateNewItem()},t.generateNewItem()}]),hospitalApp.controller("MicroReferralController",["$scope","$http","$location","globalData","microReferralData","simpleTableData","fullTableData","$interval","$rootScope",function(t,e,a,i,n,o,s,l,d){t.globalData=i,t.microReferral=n,t.simpleTableData=o,t.fullTableData=s,t._debug={globalData:i,microReferralData:n},t.prepareNew=function(){n.data=angular.copy(n.newData),s.bloodsTable.data=[],s.pcatTable.data=[],s.allergiesTable.data=[],s.followupNotesTable.data=[],s.stewardshipsTable.data=[]},t.refreshItems=function(t){e.get(window.base_url+"/micro-referral/get-all").then(function(e){""!==e.data&&(i.items=e.data),"function"==typeof t&&t(e.data)})},t.loadPatients=function(){i.loadPatients("micro_referral")},t.getInfo=function(t,a){e.get(window.base_url+"/micro-referral/get-info?id="+t).then(function(e){""!==e.data&&(0!==t&&(n.data=e.data.micro_referral,s.bloodsTable.data=e.data.bloods_table_data,s.pcatTable.data=e.data.pcat_table_data,s.allergiesTable.data=e.data.allergies_table_data,s.followupNotesTable.data=e.data.followup_notes_table_data,s.stewardshipsTable.data=e.data.stewardships_table_data),o.specialtiesList=e.data.specialties_list,o.agentsList=e.data.agents_list,o.allergiesList=e.data.allergies_list,o.reasonsList=e.data.reasons_list,o.rvsList=e.data.rvs_list,o.outcomesList=e.data.outcomes_list,o.interventionsList=e.data.interventions_list,o.indicationsList=e.data.indications_list,"function"==typeof a&&a())})},t.saveInfo=function(t){e.post(window.base_url+"/micro-referral/save-info",{data:{micro_referral:n.data,specialties_list:o.specialtiesList,agents_list:o.agentsList,allergies_list:o.allergiesList,reasons_list:o.reasonsList,rvs_list:o.rvsList,outcomes_list:o.outcomesList,interventions_list:o.interventionsList,indications_list:o.indicationsList,bloods_table_data:s.bloodsTable.data,pcat_table_data:s.pcatTable.data,allergies_table_data:s.allergiesTable.data,followup_notes_table_data:s.followupNotesTable.data,stewardships_table_data:s.stewardshipsTable.data},_csrf:document.getElementsByName("csrf-token")[0].content}).then(function(e){t(e.data)})},t.deleteInfo=function(t){e.post(window.base_url+"/micro-referral/delete-info",{data:{micro_referral_id:n.data.id},_csrf:document.getElementsByName("csrf-token")[0].content}).then(function(e){t(e.data)})}}]),hospitalApp.controller("OPATController",["$scope","$http","opatData","simpleTableData","fullTableData","globalData",function(t,e,a,i,n,o){t.globalData=o,t.opatData=a,t.simpleTableData=i,t.fullTableData=n,t._debug=o,t.prepareNew=function(){a.data=angular.copy(a.newData),n.antibioticsTable.data=[]},t.refreshItems=function(t){e.get(window.base_url+"/opat/get-all").then(function(e){""!==e.data&&(o.items=e.data),"function"==typeof t&&t(e.data)})},t.loadPatients=function(){o.loadPatients("opat")},t.getInfo=function(t,o){e.get(window.base_url+"opat/get-info?id="+t).then(function(e){""!==e.data&&(0!==t&&(a.data=e.data.opat,n.antibioticsTable.data=e.data.antibiotics_table_data),i.referringConsultantsList=e.data.referring_consultants_list,i.managingDoctorsList=e.data.managing_doctors_list,i.commisioningBoardsList=e.data.commisioning_boards_list,i.vadTypesList=e.data.vad_types_list,i.primaryInfectiveList=e.data.primary_infective_list,i.complicationsList=e.data.complications_list,i.outcomesList=e.data.outcomes_list,"function"==typeof o&&o())})},t.saveInfo=function(t){e.post(window.base_url+"opat/save-info",{data:{opat:a.data,antibiotics_table_data:n.antibioticsTable.data,referring_consultants_list:i.referringConsultantsList,managing_doctors_list:i.managingDoctorsList,commisioning_boards_list:i.commisioningBoardsList,vad_types_list:i.vadTypesList,primary_infective_list:i.primaryInfectiveList,complications_list:i.complicationsList,outcomes_list:i.outcomesList},_csrf:document.getElementsByName("csrf-token")[0].content}).then(function(e){t(e.data)})},t.deleteInfo=function(t){e.post(window.base_url+"opat/delete-info",{data:{opat_id:a.data.id},_csrf:document.getElementsByName("csrf-token")[0].content}).then(function(e){t(e.data)})}}]),hospitalApp.controller("AntibioticTableController",["$scope","opatData","fullTableData",function(t,e,a){t.newItemCopy={id:"",opat_id:"",antibiotic_id:"0",start_date:"",stop_date:"",dose:"",duration:"",frequency:"",need_change:"0"},t.fullTableData=a,a.antibioticsTable.newItem=angular.copy(t.newItemCopy),t.setNewItemId=function(){0!==a.antibioticsTable.data.length?a.antibioticsTable.newItem.id=parseInt(a.antibioticsTable.data[a.antibioticsTable.data.length-1].id)+1:a.antibioticsTable.newItem.id=1},t.generateNewItem=function(){a.antibioticsTable.newItem=angular.copy(t.newItemCopy),t.setNewItemId()},t.addItem=function(){a.antibioticsTable.data.push(angular.copy(a.antibioticsTable.newItem)),t.generateNewItem()},t.removeItem=function(e){var i=a.antibioticsTable.data.indexOf(e);a.antibioticsTable.data.splice(i,1),t.generateNewItem()},t.generateNewItem()}]),hospitalApp.controller("PatientController",["$http","$scope","globalData","microReferralData","opatData","bloodCultureMainData","$rootScope","$timeout",function(t,e,a,i,n,o,s,l){e.loadPatients(),e.globalData=a,l(function(){$("#patientsList").on("hidden.bs.modal",function(){return"manually"===$(this).attr("data-mode")?($(this).attr("data-mode",""),!1):void s.$broadcast("setActionMode",{action:"undo"})})}),e.selectPatient=function(t){if($("#patientsList").attr("data-mode","manually").modal("hide"),-1==t)return!1;var a=e.globalData.patients[t];i.data.patient_id=a.id,n.data.patient_id=a.id,o.data.patient_id=a.id,i.data.patient=a,n.data.patient=a,o.data.patient=a}}]),hospitalApp.controller("testController",["$scope",function(t){t.test={value:1},t.clickerr=function(){console.log("test")}}]);